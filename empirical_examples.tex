%!TEX root = main.tex
\section{Empirical Examples}
\label{sec:empirical}

\subsection{The Demand for Cigarettes}
\label{sec:cigarettes}
\todo[inline]{Still need to edit this section, add the reference to Baltagi, etc.}

The empirical example is based on the panel data in Baltagi et al. (2000). The data is suitable to analyze the cigarette demand of 46 American states over 30 years (1963 - 1992). In this section, we consider the model and moment selection problem together. The demand model in Baltagi et al. (2000) is as follows (all prices in real terms): 
\[
\ln C_{it} =  \gamma \ln C_{i,t-1} + \theta \ln P_{it} + \alpha W_{it} + \eta_i +  v_{it}
\] 
where $C_{it}$ is per capita sales of cigarettes, $P_{it}$ is the average retail price of a pack of cigarettes, and $\eta_i$ captures state fixed effect. The vector of all the remaining regressors is denoted as $W_{it}$ above. It includes the minimum price of cigarettes in any neighboring state $Pn_{it}$, per capita disposable income $Y_{it}$, and year dummies. After first-differencing, we obtain 
\[
\Delta \ln C_{it} = \gamma \Delta \ln C_{i,t-1} +  \theta \Delta \ln P_{it} +\alpha \Delta W_{it} +  \Delta v_{it}
\]
 Suppose we are interested in whether to use a dynamic specification of cigarette demand to estimate price elasticity. Then we can project out $\Delta W_{it}$ to rewrite the model as
\[
\widetilde{C}_{it} = \gamma \widetilde{C}_{i,t-1} + \theta \widetilde{P}_{it} + \widetilde{v}_{it} 
\] 
 
 where $\widetilde{C}_{it}$ and $\widetilde{P}_{it}$ are the residuals of $\Delta \ln C_{it}$ and $\Delta \ln P_{it}$ respectively, after projecting out $\Delta W_{it}$.
 
The model selection decision is whether or not to set $\gamma = 0$. The moment selection is whether or not to use $\ln P_{it}$ (after projecting out $\Delta W_{it})$ as an instrument for period $t$.  There are four specifications:  LW, LS, W, and S.\footnote{The specification LW we consider is different from FD-2SLS in Baltagi et al. (2000). Baltagi et al. (2000) consider the following specification without time dummies:
 \[
\Delta \ln C_{it} = \beta_1 \Delta \ln C_{i,t-1} +  \beta_2 \Delta \ln P_{it} +\beta_3 \Delta \ln Pn_{it} +  \beta_4 \Delta \ln Y_{it} + \Delta v_{it}.
\]
Furthermore, they instrument $\Delta \ln C_{i,t-1}$ by the lagged values of exogenous variables $\ln P_{it}, \ln Pn_{it}, \ln Y_{it},$ $\ln P_{i,t-1}, \ln Pn_{i,t-1}, \ln Y_{i,t-1}, \ln P_{i,t-2}, \ln Pn_{i,t-2}, \ln Y_{i,t-2}$. Instead, our specification LW use instrument $\ln C_{i, t-2}$ for $\Delta \ln C_{i,t-1}$ as suggested in Anderson and Hsiao (1982).}
 Both LW and LS include a lagged dependent variable. LW and W designate the letter W for weak exogeneity assumption. Our aim is to use the GFIC to choose between competing 2SLS estimators of $\theta$ on the basis of AMSE. %We can construct all the necessary components as in the previous simulation section.
\newpage


\begin{table}[h!]\centering
 \caption{The Estimates of Price Elasticity (Shortened data, 1975 - 1985, T=11)}
\begin{tabular}{l c c c c }\hline\hline 
 "Truncated"& LW   &      LS   &       W   &      S\\
\hline
$\theta$ & \textcolor{blue}{-0.30} & -0.26 &  -0.38 &  -0.28\\
\hline
GFIC value &0.06 & 2.22 & 0.27 &  4.34\\
Bias$^2$ & 0 & 2.21 & 0.22 & 4.33\\
Variance & 0.06 & 0.01 & 0.05 & 0.01\\ 
\hline
 "Plain" & LW   &      LS   &       W   &      S\\
\hline
$\theta$ & \textcolor{blue}{-0.30} & -0.26 &  -0.38 &  -0.28\\
\hline
GFIC value &0.06 & 2.22 & 0.27 &  4.34\\
Bias$^2$ & 0 & 2.21 & 0.22 & 4.33\\
Variance & 0.06 & 0.01 & 0.05 & 0.01\\ 
\hline
\hline
\end{tabular}
\end{table}



\begin{table}[h!]\centering
 \caption{The Estimates of Price Elasticity (Shortened data, 1975 - 1980, T=6)}
\begin{tabular}{l c c c c }\hline\hline
%\multicolumn{5}{c}{"Truncated GFIC"}\\
%\hline 
"Truncated" & LW   &      LS   &       W   &      S\\
\hline
$\theta$ & -0.68 & \textcolor{blue}{ -0.32} &  -0.28 &  -0.37\\
\hline
GFIC value &0.16 & 0.02 & 1.17 & 3.10\\
Bias$^2$ & 0 & 0 & 1.10 & 3.08\\
Variance &0.16 & 0.02 & 0.07 & 0.01\\ 
\hline
"Plain" & LW   &      LS   &       W   &      S\\
\hline
$\theta$ & -0.68 & \textcolor{blue}{ -0.32} &  -0.28 &  -0.37\\
\hline
GFIC value &0.16 & -4.18 & 1.17 & 0.07\\
Bias$^2$ & 0 & -4.20 & 1.10 & 0.05\\
Variance &0.16 & 0.02 & 0.07 & 0.01\\ 

\hline
\hline
\end{tabular}
\end{table}


\subsection{The Impact of Credit on Village Economies}
\label{sec:townsend}

Kaboski and Townsend (2012, The Impact of Credit on Village Economies, AEJ Applied Economics) study the effect of Thailand's "Million Baht Village Fund" program. 
This program is among the largest scale government microfinance initiatives in the world. 
Implemented as surprise policy initiative, the same amount of fund was given to each village which gave the transfers a plausible degree of exogeneity.
The treatment variable is the level of short-term village fund credit, and the response variable is the new short-term credit level (as in Table 3 of Kaboski and Townsend (2012)). 
I use the balanced panel for 7 years of the treated, which results in 466 households. 
I control for the household-specific fixed effects to deal with time-invariant heterogeneity.\footnote{I do not include all the independent variables as in the specification of Table 3. When conducting OLS estimation given a household, the controls such as number of adult males (females), years of schooling of head tend to be invariant for 7 years. The household fixed effect can capture all the time-invariant characteristics of household. The baseline OLS result in Table 3 of Kaboski and Townsend (2012) shows the treatment effect 12800 (standard deviation 1300) which is quite close to 11439.74 in Table 1 above.} 
The following regression is used:    
\[
\text{New short-term credit}_{it} = \alpha_i + \beta_i \cdot \text{Short-term village fund credit}_{it} + \epsilon_{it}
\]
The purpose of this section is to apply GFIC between the Ordinary Least Squares (OLS) and the Mean Group (MG) estimators. 
OLS assumes the slope homogeneity for the treatment variable whereas MG estimation allows for heterogeneous treatment effects $\beta_i = \beta + \eta_i$.  
    
\begin{table}[htbp]\centering
\caption{The Impact of Village Fund Credit}
\begin{tabular}{l  c c  }
\hline
\hline
& (1) OLS & (2) MG\\ \hline
treatment variable  &  11.44 & 8.88\\
(standard error) & (1.30) &  (1.04)\\
(clustered standard error) & (3.34)& (3.10)\\
\hline
\hline
\end{tabular}
\end{table}

For both OLS and MG specification, the treatment effect is positive and significant. However, the magnitude of treatment effect is quite dissimilar. I compute not only the standard error from the standard formula, but also the clustered standard error. The village-year clustering is considered as in Kaboski and Townsend (2012), while assuming homoskedasticity within each cluster. Suppose that there are $G$ clusters and denote $Q = I_T - \frac{1}{T} \iota_T \iota_T'$ with $\iota_T$ being vector of 1's. To specify, the robust clustered variance for OLS estimator is
\[
\big ( X'QX\big)^{-1} \big( \sum_{g=1}^{G} \sigma_{\eta,g}^2 \mathbf{x}_g'Q_g\mathbf{x}_g \mathbf{x}_g'Q_g \mathbf{x}_g \big) \big ( X'QX\big)^{-1} + \big ( X'QX\big)^{-1} \big( \sum_{g=1}^{G} \sigma_{\epsilon,g}^2 \mathbf{x}_g'Q_g \mathbf{x}_g \big) \big ( X'QX\big)^{-1}
\]
and the robust clustered variance for MG estimator is
\[
  \sum_{g=1}^{G} \sigma_{\eta,g}^2  +  \bigg [ \sum_{g=1}^{G} \sigma_{\epsilon,g}^2\big( \mathbf{x}_g'Q_g \mathbf{x}_g \big)^{-1} \bigg ].
\]

We can compute the consistent estimator for $\sigma_{\epsilon,g}^2$ as
\[
\widehat{\sigma}_{\epsilon,g}^2 = \frac{\mathbf{y}_g'M_{Q_g\mathbf{x}_g}\mathbf{y}_g}{N_gT-1}
\]

where $N_g$ is the number of households within a cluster. Also, we can compute the consistent estimator for $\sigma_{\eta,g}^2$ to be

\[
\widehat{\sigma}_{\eta,g}^2 = \frac{S_{b,g}}{G-1} - \frac{1}{G} \sum_{g=1}^G \widehat{\sigma}_{\epsilon,g}^2 \big(\mathbf{x}_g' Q_g \mathbf{x}_g \big)^{-1}
\]

where $S_{b,g} = \sum_{g=1}^G \widehat{\beta}_g \widehat{\beta}_g' - \frac{1}{G} \sum_{g=1}^G \widehat{\beta}_g \sum_{g=1}^G \widehat{\beta}_g'$.
There are 55 clusters in total and it turns out that the clustered standard errors are bigger than the standard error without clustering. 
If there exists slope heterogeneity, the OLS estimator would be biased. 
Since the standard errors for the MG estimator is already smaller than the OLS estimator, there is no additional trade-off to be concerned between bias and variance. 
However, if there is the case where the MG estimation has higher variance, we need to consider the trade-off between bias and variance. 
The bias $\big(E[\mathbf{x}_iQ\mathbf{x}_i]\big)^{-1}\delta$ can be computed using the asymptotic distribution of $\delta = \sqrt{N}\sum_{t=1}^T E[(x_{it}-\bar{x}_i)^2\eta_i]$ under the local misspecification, whose asymptotically unbiased estimator is 

\[
\widehat{\delta} = \frac{1}{\sqrt{N}} \sum_{i=1}^N \mathbf{x}_i'Q(\mathbf{y}_i - \mathbf{x}_i \widehat{\beta}_{MG})
\]

From the asymptotic distribution of $\widehat{\delta}$, we obtain $\widehat{\delta} \rightarrow_d N\big(\delta , \Omega_\delta\big)$ where $\Omega_\delta = \sigma_\eta^2 E[\mathbf{x}_i'Q \mathbf{x}_i \mathbf{x}_i'Q\mathbf{x}_i] - \sigma_\eta^2 \big(E[\mathbf{x}_i'Q\mathbf{x}_i]\big)^2 - \sigma_\epsilon^2 E[\mathbf{x}_i'Q\mathbf{x}_i] + \sigma_\epsilon^2 \big(E[\mathbf{x}_i'Q\mathbf{x}_i]\big)^2 E\big((\mathbf{x}_i'Q\mathbf{x}_i)^{-1}\big)$. We can construct the consistent estimator $\widehat{\Omega}_\delta$ using the sample means, $\widehat{\sigma}_\epsilon^2,$ and $\widehat{\sigma}_\eta^2$. The asymptotically unbiased estimator for $\delta^2$ is $\widehat{\delta}^2 - \widehat{\Omega}_\delta$. The FMSC, which is the asymptotically unbiased estimator of AMSE, for each estimator is as follows:

\begin{table}[htbp]\centering
\caption{The FMSC for the Estimators}
\begin{tabular}{l  c c  }
\hline
\hline
"Truncated"& (1) OLS & (2) MG\\ 
FMSC &  3631.71 & 1.08\\
\hline
"Plain"& (1) OLS & (2) MG\\ 
FMSC &  3631.71 & 1.08\\
\hline
\hline
\end{tabular}
\end{table}


